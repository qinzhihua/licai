define("user:page/setting/modifyPages/modifyEmailByOld/modifyEmailByOld.js",function(require,exports,module){"use strict";var service=(require("common:widget/ui/utils/utils"),require("common:widget/ui/service/service-factory")),settingService=service.getService("setting"),modifyEmailByOld={init:function(){var _this=this;this.error="不能为空",this.checkType=$("#checkType").val(),this.step=1,$("#sub-email-update-byold-stepone").on("click",function(){_this.sendEmail()}),$("#re-send-mail").on("click",function(){_this.sendEmailAgain()}),$("#code").keyup(function(){_this.validateCode()});var $randImage=$("#randImage"),originCaptcha=$randImage.attr("src");$randImage.on("click",function(){$randImage.attr("src",originCaptcha+"?"+(new Date).getTime())})},sendEmail:function(){var _this2=this,that=this;if(!that.validateCode()){var code=$("#code").val();settingService.sendCheckOldEmail({imgCode:code}).then(function(res){if(res.requestStatus!==settingService.STATUS.SUCCESS){var msg=res.data?res.data.message:"请求后端服务出错, 请稍后再试";return Promise.reject(new Error(msg))}var data=res.data;if(0!=data.status)return _this2.error=data.message,_this2.errorModal(0),!0;var $s=$(".success");$s.length&&($(".inputs").delay(1e3).slideUp(),$s.delay(1e3).slideDown())}).caught(function(e){$(".error").text(e.message)})}},sendEmailAgain:function(){var data={mailType:"",newEmail:""};settingService.sendCheckEmailAgain(data).then(function(res){if(res.requestStatus!==settingService.STATUS.SUCCESS){var msg=res.data?res.data.message:"请求后端服务出错, 请稍后再试";return Promise.reject(new Error(msg))}var _data=res.data;0==_data.status?$(".catch-success").slideDown(1e3).delay(2e3).slideUp(1e3):$(".catch-error").text(_data.message).slideDown(1e3).delay(2e3).slideUp(1e3)}).caught(function(e){$(".catch-error").text(e.message).slideDown(1e3).delay(2e3).slideUp(1e3)})},validateCode:function(){var code=$("#code").val();return code?void 0:(this.error="验证码不能为空",this.errorModal(0),!0)},errorModal:function(num){$("label.error").eq(num).text(this.error),this.error?$(".ui-input-setting").eq(num).addClass("error"):$(".ui-input-setting").eq(num).removeClass("error")}};module.exports=modifyEmailByOld});